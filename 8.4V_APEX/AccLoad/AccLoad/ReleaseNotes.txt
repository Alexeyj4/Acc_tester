29.03.2023
Встроенная программа для прошивки испытательного стенда АКБ АПЕКС (Arduino Mega 2560)
Техподдержка ASharonov@it-ind.ru

В коде: 
#define numOfSlots 2 - настройка количества подключенных слотов для теста АКБ
#define array_len 20 - размер массива для хранения измерений и подсчёта средненго перед передачей в порт (фильтр пульсаций)
#define valid_threshold 230 - порог правильности измерения (в единицах АЦП). Если в массиве измерений разница между максимальным и минимальным больше порога - результат считается недействительным и не передаётся в порт
const int Upin[]={14,16,18,14,16,18,14,16}; - пины для изерения напряжения (для слота 0,1,...)
const int Ipin[]={15,17,19,15,17,19,15,17}; - пины для измрения тока (для слота 0,1,...)
const float Ucal[]={32.7,32.7,32.7,32.7,32.7,32.7,32.7,32.7}; - массив для калибровки и перевода напряжения из единиц АЦП в вольты
const float Ical[]={229.1,229.1,229.1,229.1,229.1,229.1,229.1,229.1}; - массив для калибровки и перевода тока из единиц АЦП в амперы

Программа последовательно проводит измерения напряжения и тока на каждом слоте, заносит в массив.
Когда массив измерений заполняется - считает среднее и передаёт в порт (для фильтрации пульсаций).
Перед отправкой проверяется разница между максимальным и минимальным в массиве значений и, если разница больше порога - передача пропускается (результат измерения считается некорректным).

Протокол передачи:
slot\r\n - контрольное слово "slot"
1\r\n	- номер слота (0,1,2...)
8.15\r\n - напряжение в вольтах
1.25\r\n - ток в амперах

